---
title: "Internal Directory Structure"
weight: 403
---

The Drive system organizes its files and directories in a structured manner to maintain separation of responsibilities and facilitate management. This section documents the complete directory structure and the purpose of each.

## Main Structure

```
/home/ubuntu/
├── .infinited/              # Main node directory
│   ├── config/              # Configuration files
│   │   ├── genesis.json     # Blockchain genesis file
│   │   ├── config.toml      # Node configuration
│   │   └── ...              # Other configuration files
│   ├── data/                # Blockchain data
│   │   ├── blocks/          # Downloaded blocks
│   │   ├── state.db/        # State database
│   │   └── ...              # Other blockchain data
│   └── keyring-file/        # Keyring (cryptographic keys)
│       └── ...              # Key files
│
├── .node/                   # Node control directory
│   ├── node.pid             # Node process PID
│   ├── supervisor.pid       # Supervisor process PID
│   └── auto-start           # Auto-start flag
│
└── (other user files)

/var/log/node/               # System logs
├── node.log                 # Main node log
└── supervisor.log        # Supervisor log

/usr/local/bin/              # System binaries and scripts
├── infinited                # Blockchain node binary
├── node-init                # Initialization script
├── node-start               # Startup script
├── node-stop                # Shutdown script
├── node-logs                # Log viewing script
├── node-keys                # Key management script
├── node-supervisor          # Supervisor script
├── node-auto-start          # Auto-start script
└── ...                      # Other scripts
```

## Detailed Directories

### 1. `/home/ubuntu/.infinited/` - Main Node Directory

This is the blockchain node's home directory, where all node data and configurations are stored.

**Purpose:**
- Contains all node configuration
- Stores blockchain data
- Contains the keyring with cryptographic keys

**Subdirectories:**

#### `config/`
Contains all node configuration files.

**Important files:**
- `genesis.json` - Blockchain genesis file (defines initial state)
- `config.toml` - Main node configuration (ports, peers, etc.)
- `app.toml` - Application configuration
- `client.toml` - Client configuration

**Related variables:**
- `NODE_HOME` = `/home/ubuntu/.infinited`
- `NODE_GENESIS_FILE` = `${NODE_HOME}/config/genesis.json`
- `NODE_CONFIG_FILE` = `${NODE_HOME}/config/config.toml`

#### `data/`
Contains all blockchain data that the node has downloaded and processed.

**Content:**
- `blocks/` - Blockchain blocks
- `state.db/` - State database (current blockchain state)
- `application.db/` - Application database
- Other data files generated by the node

**Note:** This directory can grow significantly as the node synchronizes with the network.

#### `keyring-file/`
Contains the node's cryptographic keys.

**Content:**
- Encrypted key files
- Keyring information
- Validator keys (if applicable)

**Related variable:**
- `NODE_KEYRING_BACKEND` = `file` (always uses file keyring)

**Complete location:**
```
/home/ubuntu/.infinited/keyring-file/
```

### 2. `/home/ubuntu/.node/` - Control Directory

This directory contains control and state files for the node management system.

**Purpose:**
- Store process PIDs
- Maintain control flags
- Manage system state

**Files:**

#### `node.pid`
Contains the PID (Process ID) of the running blockchain node process.

**Format:**
```
12345
```

**Usage:**
- Read by `node-stop` to stop the node
- Updated by `node-start` when the node starts
- Deleted when the node stops

**Related variable:**
- `NODE_PID_FILE` = `~/.node/node.pid`

#### `supervisor.pid`
Contains the supervisor process PID.

**Format:**
```
12346
```

**Usage:**
- Read by `node-stop` to stop the supervisor
- Updated by `node-start` when the supervisor starts
- Deleted when the supervisor stops

**Related variable:**
- `NODE_SUPERVISOR_PID_FILE` = `~/.node/supervisor.pid`

#### `auto-start`
Flag file that indicates the node should start automatically.

**Format:**
- Empty file (its existence is what matters)

**Usage:**
- Created by `node-start` when the user manually starts the node
- Deleted by `node-stop` when the user stops the node
- Checked by `node-auto-start.sh` when the container starts
- Checked by `node-supervisor.sh` to decide whether to restart the node

**Related variable:**
- `NODE_AUTO_START_FLAG` = `~/.node/auto-start`

**Related variable:**
- `NODE_CONTROL_DIR` = `/home/ubuntu/.node`

### 3. `/var/log/node/` - Log Directory

This directory contains all node system logs.

**Purpose:**
- Store blockchain node logs
- Store supervisor logs
- Facilitate debugging and monitoring

**Files:**

#### `node.log`
Main blockchain node log.

**Content:**
- Standard output and error from the `infinited` process
- Synchronization messages
- Node errors and warnings
- Peer connection information

**Related variable:**
- `NODE_LOG_FILE` = `/var/log/node/node.log`

**Usage:**
- Viewed with `node-logs` or `node-logs -f` (real-time following)
- Monitored by the supervisor to detect problems

#### `supervisor.log`
Supervisor process log.

**Content:**
- Monitoring events
- Node stopped detection
- Restart attempts
- Supervision stop

**Related variable:**
- `NODE_SUPERVISOR_LOG_FILE` = `/var/log/node/supervisor.log`

**Entry format:**
```
[2024-01-15 10:30:45] Node not detected, attempting to restart...
[2024-01-15 10:30:50] Auto-start flag removed, stopping supervision...
```

### 4. `/usr/local/bin/` - System Binaries and Scripts

This directory contains system binaries and executable scripts.

**Purpose:**
- Store the blockchain node binary
- Contain all node management scripts
- Be in the system PATH for easy access

**Important files:**

#### `infinited`
Main blockchain node binary.

**Location:**
```
/usr/local/bin/infinited
```

**Related variable:**
- `NODE_BINARY_PATH` = `/usr/local/bin/infinited`

**Usage:**
- Executed directly by management scripts
- Main blockchain node process

#### Management Scripts

All scripts have the `.sh` extension removed and are in `/usr/local/bin/`:

- `node-init` - Node initialization
- `node-start` - Node startup
- `node-stop` - Node shutdown
- `node-logs` - Log viewing
- `node-keys` - Key management
- `node-supervisor` - Node supervisor
- `node-auto-start` - Auto-start on container startup
- `node-clean-data` - Data cleanup
- `node-process-status` - Process status
- `node-network-diagnosis` - Network diagnosis
- `node-ui` - Graphical user interface
- And other utility scripts

## Permissions and Ownership

### User and Group

All files and directories belong to the `ubuntu` user (UID 1000, GID 1000).

**Configuration:**
```bash
USER 1000:1000
```

**Applied to:**
- `/home/ubuntu/` and all its content
- `/var/log/node/` and all its content
- Scripts in `/usr/local/bin/node-*`

### Directory Permissions

Main directories have standard permissions:

- `/home/ubuntu/.infinited/` - `755` (rwxr-xr-x)
- `/home/ubuntu/.node/` - `755` (rwxr-xr-x)
- `/var/log/node/` - `755` (rwxr-xr-x)

### File Permissions

- Configuration files - `644` (rw-r--r--)
- Executable scripts - `755` (rwxr-xr-x)
- PID files - `644` (rw-r--r--)
- Logs - `644` (rw-r--r--)

## Directory Creation

Directories are created automatically when needed:

**In the Dockerfile:**
```dockerfile
RUN mkdir -p /home/ubuntu/.infinited /var/log/node /home/ubuntu/.node && \
    chown -R 1000:1000 /home/ubuntu /var/log/node
```

**In scripts:**
```bash
# Create control directory if it doesn't exist
mkdir -p "$NODE_CONTROL_DIR"

# Create log directory if it doesn't exist
mkdir -p "$(dirname "$NODE_LOG_FILE")"
```

## Data Persistence

### Persistent Data

The following directories contain data that must persist:

1. **`~/.infinited/`** - All node configuration and data
2. **`~/.node/`** - Control state (though it can be regenerated)

### Non-Persistent Data

The following files are automatically regenerated:

1. **`~/.node/node.pid`** - Created on startup, deleted on shutdown
2. **`~/.node/supervisor.pid`** - Created when supervisor starts, deleted when it stops
3. **`/var/log/node/*.log`** - Can be regenerated (though they contain valuable information)

## Docker Volume Mapping

In a Docker environment, these directories are typically mapped to persistent volumes:

```yaml
volumes:
  - ./persistent-data/.infinited:/home/ubuntu/.infinited
  - ./persistent-data/.node:/home/ubuntu/.node
  - ./persistent-data/logs:/var/log/node
```

## Related Configuration Variables

```bash
NODE_HOME="/home/ubuntu/.infinited"
NODE_CONTROL_DIR="/home/ubuntu/.node"
NODE_LOG_FILE="/var/log/node/node.log"
NODE_SUPERVISOR_LOG_FILE="/var/log/node/supervisor.log"
NODE_BINARY_PATH="/usr/local/bin/infinited"
NODE_GENESIS_FILE="${NODE_HOME}/config/genesis.json"
NODE_CONFIG_FILE="${NODE_HOME}/config/config.toml"
NODE_PID_FILE="${NODE_CONTROL_DIR}/node.pid"
NODE_SUPERVISOR_PID_FILE="${NODE_CONTROL_DIR}/supervisor.pid"
NODE_AUTO_START_FLAG="${NODE_CONTROL_DIR}/auto-start"
```

## See Also

- [Internal Configuration System]({{< relref "configuration-system" >}}) - Variables and configuration
- [Internal Logging System]({{< relref "logging-system" >}}) - Details about the logging system
- [Container Architecture]({{< relref "container-architecture" >}}) - How these directories are created in the build

